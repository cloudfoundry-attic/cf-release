# abort script on any command that exit with a non zero value
set -e

cd ${BUILD_DIR}

mv warden warden_meta

cp -a warden_meta/warden .

# Warden requires warden-client gem
gem build warden_meta/warden-client/warden-client.gemspec
mkdir -p warden/vendor/cache
cp warden-client*.gem warden/vendor/cache

pkg_utils/vendor.sh warden

rm -rf warden_meta
rm -rf core
rm -rf pkg_utils