---
name: login

logging:
  config: /var/vcap/jobs/login/config/log4j.properties

<% protocol = p("login.protocol") %> # http or https
<% unless properties.login.uaa_base
  # Fix this to https when SSL certs are working in dev and staging
  uaa_base = "#{protocol}://uaa.#{properties.domain}"
else
  uaa_base = properties.login.uaa_base
end %>
uaa:
  url: <%= uaa_base %>
  token:
    url: <%= uaa_base %>/oauth/token
  login:
    url: <%= uaa_base %>/authenticate
  clientinfo:
    url: <%= uaa_base %>/clientinfo
  approvals:
    url: <%= uaa_base %>/approvals

links:
  home:   <%= p("login.links.home") %>
  passwd: <%= p("login.links.passwd") %>
  signup: <%= p("login.links.signup") %>

<% if !properties.uaa.clients || !properties.uaa.clients.login %>
LOGIN_SECRET: <%= properties.uaa.login.client_secret %>
<% else %>
LOGIN_SECRET: <%= properties.uaa.clients.login.secret %>
<% end %>
<% if !properties.uaa.require_https.nil? %>
require_https: <%= properties.uaa.require_https %>
<% end %>
<% if !properties.uaa.dump_requests.nil? %>
dump_requests: <%= properties.uaa.dump_requests %>
<% end %>

login.authorize.url: <%= "#{protocol}://login.#{properties.domain}/oauth/authorize" %>

<% if properties.login.analytics && properties.login.analytics.code && properties.login.analytics.domain %>
analytics:
  code: <%= properties.login.analytics.code %>
  domain: <%= properties.login.analytics.domain %>
<% end %>
